indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, area_name1)))
option_list %>% bind_rows
View(options2)
option_list %>% bind_rows %>% select(artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration)
names(option_list)
option_list %>% bind_rows %>% select(artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration) %>%
mutate(source = names(option_list))
option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration) %>%
names(option_list)
option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration)
full_res %>%
filter(
#area_level ==2,
area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "15-49", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=version)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~source, ncol=2) +
coord_flip() +
labs(x="", y="ART Coverage", title="15-49 ART coverage in Maputo City & neighbouring districts")
full_res %>%
filter(
#area_level ==2,
area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "15-49", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
coord_flip() +
labs(x="", y="ART Coverage", title="15-49 ART coverage in Maputo City & neighbouring districts")
full_res %>%
filter(
#area_level ==2,
area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
coord_flip() +
labs(x="", y="ART Coverage", title="15-49 ART coverage in Maputo City & neighbouring districts")
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
coord_flip() +
labs(x="", y="ART Coverage", title="15-49 ART coverage in Maputo City & neighbouring districts")
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
ylim(0,2)
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
ylim(0,2) +
coord_flip() +
labs(x="", y="ART Coverage", title="15-49 ART coverage in Maputo City & neighbouring districts")
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(3),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==2,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(3),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(3),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(2),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
View(naomi_data)
lapply(naomi_data, "[[", "calibration_options")
View(ind_plot)
View(full_res)
art <- read_csv("~/Downloads/tarvnaomi.csv")
View(art)
art %>% filter(age_group == "00-14") %>% group_by(year) %>% summarise(tot = sum(current_art))
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both")
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both", source == "Mod_1_share")
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both", source == "Mod_1_share", indicator == "art_num_attend")
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both", source == "Mod_1_share", indicator == "art_num_attend") %>% select(area_level, sex, age_group, quarter_label, indicator, mean)
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both", source == "Mod_1_share", indicator == "art_num_attend") %>% select(area_level, sex, age_group, quarter_label, indicator, mean, version)
art <- read_csv("~/Downloads/tarvnaomi.csv")
art %>% filter(age_group == "00-14") %>% group_by(year) %>% summarise(tot = sum(current_art))
full_res %>% filter(age_group == "00-14", area_level ==0, sex == "both", source == "Mod_1_share", indicator == "art_num_attend") %>% select(area_level, sex, age_group, quarter_label, indicator, mean, version)
View(options3)
full_res %>% filter(age_group_label == "all ages")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", source == "Mod_1_share")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", source == "Mod_1_share", indicator == "art_num_resident")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", source == "Mod_1_share", indicator == "art_num_residents")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", source == "Mod_1_share", indicator == "art_num_residents", sex=="both")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator == "art_num_residents", sex=="both")
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator == "art_num_residents", sex=="both", quarter_id == 480)
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator == "art_num_residents", sex=="both", quarter_id == 480) %>% select(source, version, area_name, mean)
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>% select(source, version, area_name, indicator, mean)
full_res %>% filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>% select(source, version, area_name, indicator, mean) %>% arrange(indicator)
full_res %>%
filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>%
select(source, version, area_name, indicator, mean) %>%
arrange(source, indicator)
option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration)
full_res %>%
filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>%
select(source, version, area_name, indicator, mean) %>%
arrange(source, indicator) %>%
left_join(option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration))
View(
full_res %>%
filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>%
select(source, version, area_name, indicator, mean) %>%
arrange(source, indicator) %>%
left_join(option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration))
)
options_list[[1]]
option_list[[1]]
View(naomi_data)
View(option_list)
option_list[["Mod_1"]]
View(naomi_data)
View(
full_res %>%
filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>%
select(source, version, area_name, indicator, mean) %>%
arrange(source, indicator) %>%
left_join(option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration))
)
outputs[1] <- calibrate_outputs(out[1], naomi_data[1],
option_list[1]$spectrum_plhiv_calibration_level,
option_list[1]$spectrum_plhiv_calibration_strat,
option_list[1]$spectrum_artnum_calibration_level,
option_list[1]$spectrum_artnum_calibration_strat)
outputs[[1]] <- calibrate_outputs(out[[1]], naomi_data[[1]],
option_list[[1]]$spectrum_plhiv_calibration_level,
option_list[[1]]$spectrum_plhiv_calibration_strat,
option_list[[1]]$spectrum_artnum_calibration_level,
option_list[[1]]$spectrum_artnum_calibration_strat)
outputs <- list()
outputs[[1]] <- calibrate_outputs(out[[1]], naomi_data[[1]],
option_list[[1]]$spectrum_plhiv_calibration_level,
option_list[[1]]$spectrum_plhiv_calibration_strat,
option_list[[1]]$spectrum_artnum_calibration_level,
option_list[[1]]$spectrum_artnum_calibration_strat)
outputs[[2]] <- calibrate_outputs(out[[2]], naomi_data[[2]],
option_list[[2]]$spectrum_plhiv_calibration_level,
option_list[[2]]$spectrum_plhiv_calibration_strat,
option_list[[2]]$spectrum_artnum_calibration_level,
option_list[[2]]$spectrum_artnum_calibration_strat)
outputs[[3]] <- calibrate_outputs(out[[3]], naomi_data[[3]],
option_list[[3]]$spectrum_plhiv_calibration_level,
option_list[[3]]$spectrum_plhiv_calibration_strat,
option_list[[3]]$spectrum_artnum_calibration_level,
option_list[[3]]$spectrum_artnum_calibration_strat)
outputs[[4]] <- calibrate_outputs(out[[4]], naomi_data[[4]],
option_list[[4]]$spectrum_plhiv_calibration_level,
option_list[[4]]$spectrum_plhiv_calibration_strat,
option_list[[4]]$spectrum_artnum_calibration_level,
option_list[[4]]$spectrum_artnum_calibration_strat)
outputs[[5]] <- calibrate_outputs(out[[5]], naomi_data[[5]],
option_list[[5]]$spectrum_plhiv_calibration_level,
option_list[[5]]$spectrum_plhiv_calibration_strat,
option_list[[5]]$spectrum_artnum_calibration_level,
option_list[[5]]$spectrum_artnum_calibration_strat)
outputs[[6]] <- calibrate_outputs(out[[6]], naomi_data[[6]],
option_list[[6]]$spectrum_plhiv_calibration_level,
option_list[[6]]$spectrum_plhiv_calibration_strat,
option_list[[6]]$spectrum_artnum_calibration_level,
option_list[[6]]$spectrum_artnum_calibration_strat)
View(outputs)
indicators_raked <- lapply(outputs, add_output_labels)
View(indicators_raked)
artattend_raked <- lapply(outputs, add_art_attendance_labels)
names(option_list) <- names(indicators_raked) <- names(artattend_raked) <- c(paste0("Mod_", 1:3), paste0("Mod_", 1:3, "_share"))
ind_plot <- indicators_raked %>%
bind_rows(.id="source") %>%
mutate(version = "development")
full_res <- ind_plot %>%
bind_rows(res)
full_res %>%
filter(age_group_label == "all ages", area_id == "MOZ_1_01", indicator %in% c("art_num_residents", "plhiv"), sex=="both", quarter_id == 480) %>%
select(source, version, area_name, indicator, mean) %>%
arrange(source, indicator) %>%
left_join(option_list %>% bind_rows %>% mutate(source = names(option_list)) %>%
select(source, artattend, spectrum_plhiv_calibration_level, spectrum_artnum_calibration_level, spectrum_population_calibration))
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(3),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(2),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(5),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
ind_plot <- indicators_raked %>%
bind_rows(.id="source") %>%
mutate(version = "development_raked") %>%
bind_rows(indicators %>%
bind_rows(.id="source") %>%
mutate(version = "development"))
full_res <- ind_plot %>%
bind_rows(res)
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(5),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
full_res %>%
filter(
area_level ==1,
#area_name %in% c("KaMubukwana", "KaMavota", "Nhlamanukunu", "KaMaxakeni", "KaMpfumu", "KaTembe", "KaNyaka", "Matola", "Boane", "Matutuine", "Marracuene"),
#area_id %in% c("MOZ_1_01", "MOZ_1_02"),
age_group == "00-14", #20
sex == "both",
indicator_id %in% c(4),
quarter_id == 480
) %>%
left_join(areas_wide %>% select(area_id, area_name1)) %>%
mutate(area_name = fct_reorder(area_name, desc(area_name1))) %>%
ggplot(aes(x=area_name, y=mean, fill=source)) +
geom_bar(position="dodge", stat="identity") +
#geom_hline(aes(yintercept=1), linetype=3, alpha=0.8) +
facet_wrap(~version, ncol=2) +
#ylim(0,2) +
coord_flip()
install.packages("TMB")
precompile()
library(TMB)
precompile()
install.packages("Matrix")
install.packages("Matrix")
install.packages("Matrix")
install.packages("Matrix")
install.packages("Matrix")
library(Matrix)
install.packages("Matrix")
library(Matrix)
install.packages("TMB")
library(TMB)
precompile()
setupRStudio()
tmb::setupRStudio()
tmb:::setupRStudio()
TMB:::setupRStudio()
library(TMB)
library(tidyverse)
?gbdsource
install.packages("gbdsource")
setwd("~/Documents/GitHub/subnat_fertility/")
gdbsource(tmd.R)
gdbsource("tmb.R")
gdbsource()
?gdbsource
